server.port=8080
spring.application.name=api-gateway

eureka.client.service-url.defaultZone=http://localhost:8761/eureka
eureka.instance.prefer-ip-address=true

spring.cloud.gateway.discovery.locator.enabled=true
spring.cloud.gateway.discovery.locator.lower-case-service-id=true

resilience4j.circuitbreaker.configs.default.slidingWindowSize=10
resilience4j.circuitbreaker.configs.default.failureRateThreshold=50
resilience4j.circuitbreaker.configs.default.waitDurationInOpenState=5s
resilience4j.circuitbreaker.configs.default.permittedNumberOfCallsInHalfOpenState=3
resilience4j.circuitbreaker.configs.default.automaticTransitionFromOpenToHalfOpenEnabled=true

management.endpoints.web.exposure.include=health,gateway,routes
management.endpoint.health.show-details=always
management.endpoint.gateway.enabled=true

spring.cloud.gateway.globalcors.cors-configurations.[/api/**].allowed-origins=*
spring.cloud.gateway.globalcors.cors-configurations.[/api/**].allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.globalcors.cors-configurations.[/api/**].allowed-headers=*

# ??????????? ????????
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.reactor.netty.http.client=DEBUG

# Rate Limiting (?????????????)
spring.cloud.gateway.filter.request-rate-limiter.enabled=true
spring.cloud.gateway.filter.request-rate-limiter.redis-rate-limiter.replenishRate=10
spring.cloud.gateway.filter.request-rate-limiter.redis-rate-limiter.burstCapacity=20

# Retry Pattern
spring.cloud.gateway.filter.retry.max-retries=3
spring.cloud.gateway.filter.retry.statuses=SERVICE_UNAVAILABLE,INTERNAL_SERVER_ERROR

# Timeouts
spring.cloud.gateway.httpclient.connect-timeout=1000
spring.cloud.gateway.httpclient.response-timeout=5000

# Distributed Tracing
management.tracing.sampling.probability=1.0